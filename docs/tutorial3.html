<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Matéo Moglia">
<meta name="dcterms.date" content="2025-05-05">

<title>Tutorial 3 – Petite classe ECO1S002</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-94ab712f215f0f28cf75fcc61d4e0fd5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./tutorial3.html">Tutorial 3</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Petite classe ECO1S002</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Tutorial 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 4</span></a>
  </div>
</li>
        <li class="sidebar-item">
 <span class="menu-text">Tutorial 5</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 6</span></a>
  </div>
</li>
        <li class="sidebar-item">
 <span class="menu-text">Tutorial 7</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 8</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 9</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 10</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 11</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="tutorial3.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tutorial 3</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://mateomoglia.github.io">Matéo Moglia</a> <a href="mailto:mateo.moglia@gmail.com" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            CREST - Institut Polytechnique de Paris
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 5, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="roadmap" class="level2">
<h2 class="anchored" data-anchor-id="roadmap">Roadmap</h2>
<p>For this third tutorial, we are going to</p>
<ol type="1">
<li>Recap on the OLS estimation</li>
<li>Learn how to go from a model to an empirical prediction</li>
<li>Replicate the key results from Mankiw, Romer, Weil (1994)</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Big disclaimer: the recap on OLS is hugely inspired from Florian Oswald’s and Sciences Po’s introduction to Econometrics with R. The interested student can check this fantastical material here: <a href="scpoecon.github.io">scpoecon.github.io</a>.</p>
</div>
</div>
</section>
<section id="linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression">Linear regression</h2>
<section id="why-when" class="level3">
<h3 class="anchored" data-anchor-id="why-when">Why? When?</h3>
<ol type="1">
<li>An empirical tool to assess the statistical relationship between variables</li>
<li>In the toolbox of the social scientist, with many other tools</li>
<li>Correlation <strong>is not</strong> causation</li>
</ol>
<p>Topic of today: <strong>Ordinary Least Square</strong> estimator (which is a widely used estimator)</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Keep in mind the difference between an estimator <span class="math inline">\(\hat \beta\)</span> and the observed value <span class="math inline">\(\beta\)</span>. We cannot observe the true parameter, so we estimate it (with <strong>error</strong>).</p>
</div>
</div>
</section>
</section>
<section id="linear-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-1">Linear regression</h2>
<section id="visual-intuition" class="level3">
<h3 class="anchored" data-anchor-id="visual-intuition">Visual intuition</h3>
<p>We use the <code>cars</code> dataset, in base R, and we are going to relate how speed and stopping distance are related.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cars,<span class="fu">aes</span>(<span class="at">x=</span>speed,<span class="at">y=</span>dist)) <span class="sc">+</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Speed"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Stopping distance"</span>) <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Car speed vs. stopping distance"</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial3_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="linear-regression-2" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-2">Linear regression</h2>
<section id="visual-intuition-1" class="level3">
<h3 class="anchored" data-anchor-id="visual-intuition-1">Visual intuition</h3>
<p>It seems that a line could be helpful to “summarize” the relation between both variables!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cars,<span class="fu">aes</span>(<span class="at">x=</span>speed,<span class="at">y=</span>dist)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">10</span>,<span class="at">slope=</span><span class="fl">2.5</span>,<span class="at">color=</span><span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Speed"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Stopping distance"</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Car speed vs. stopping distance"</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial3_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="linear-regression-3" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-3">Linear regression</h2>
<section id="bringing-some-maths" class="level3">
<h3 class="anchored" data-anchor-id="bringing-some-maths">Bringing some maths</h3>
<ul>
<li>We want to minimize the distance between the line and the points</li>
<li>In practice, the sum of distances can go to 0. Solution?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cars, <span class="fu">aes</span>(<span class="at">x =</span> speed, <span class="at">y =</span> dist)) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">5</span>, <span class="at">slope =</span> <span class="fl">2.5</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> speed, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> dist, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> speed, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> <span class="dv">5</span> <span class="sc">+</span> <span class="fl">2.5</span> <span class="sc">*</span> speed), </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"inches"</span>)), </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Speed"</span>) <span class="sc">+</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Stopping distance"</span>) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Car speed vs. stopping distance"</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial3_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="linear-regression-4" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-4">Linear regression</h2>
<section id="bringing-some-maths-1" class="level3">
<h3 class="anchored" data-anchor-id="bringing-some-maths-1">Bringing some maths</h3>
<ul>
<li><p>We compute the sum of square distances (<span class="math inline">\(\sim\)</span> error), so the name “ordinary least square”</p></li>
<li><p>An affine function is defined as <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span> which in matrix form gives <span class="math inline">\(Y = X\beta\)</span>.</p></li>
<li><p>Dimension of <span class="math inline">\(X\)</span>?</p></li>
<li><p>The error for each observation is <span class="math inline">\(e_i = y_i - \beta_0 - \beta_1 x_i\)</span></p></li>
<li><p>Hence, we look for <span class="math inline">\(\beta\)</span> such that: <span class="math display">\[
\beta^\star = \min_\beta (Y - X\beta)'(Y - X\beta) = \min_\beta e'e
\]</span></p></li>
<li><p>First order condition: derivative wrt <span class="math inline">\(\beta\)</span> should be equal to 0</p></li>
</ul>
</section>
</section>
<section id="linear-regression-5" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-5">Linear regression</h2>
<section id="defining-the-ols-estimator" class="level3">
<h3 class="anchored" data-anchor-id="defining-the-ols-estimator">Defining the OLS estimator</h3>
<ul>
<li><p>The OLS estimator is then: <span class="math display">\[
\hat{\beta} = (X'X)^{-1}X'y
\]</span></p></li>
<li><p>Who wants to try to derive it?</p></li>
<li><p>Under some conditions, this estimator is the <strong>Best Linear Unbiased Estimator</strong> (BLUE)</p></li>
<li><p>Those conditions will be super helpful later</p></li>
</ul>
</section>
</section>
<section id="linear-regression-6" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-6">Linear regression</h2>
<section id="gauss-markov-theorem" class="level3">
<h3 class="anchored" data-anchor-id="gauss-markov-theorem">Gauss-Markov theorem</h3>
<ol type="1">
<li>Linearity
<ul>
<li>The relationship has to be linear</li>
<li>See <a href="#appendix" class="btn btn-primary">Anscombe quartet</a></li>
<li>Solutions: <span class="math inline">\(\log\)</span>, squared</li>
</ul></li>
<li><span class="math inline">\(X\)</span> is full rank
<ul>
<li>Ensure that variables are not perfectly colinear</li>
<li>There are more observations than variables (<span class="math inline">\(n &gt; k\)</span>)</li>
</ul></li>
<li>Zero conditional mean
<ul>
<li>Errors are not correlated with <span class="math inline">\(X\)</span> (<strong>exogeneity</strong>)</li>
</ul></li>
<li>Homoskedasticity
<ul>
<li>Errors are not correlated between observations</li>
<li>Solutions: robust estimation</li>
</ul></li>
</ol>
</section>
</section>
<section id="linear-regression-7" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-7">Linear regression</h2>
<section id="gauss-markov-theorem-violation" class="level3">
<h3 class="anchored" data-anchor-id="gauss-markov-theorem-violation">Gauss-Markov theorem violation</h3>
<p>Major threat is 3 (= <strong>endogeneity</strong>). Usually it arises from 2 sources:</p>
<ol type="1">
<li>Reverse causality. Any exemple?</li>
<li>Omitted Variable Bias. Any exemple?</li>
</ol>
<p>Then, the OLS estimator is <strong>biased</strong> and <span class="math inline">\(E(\widehat\beta)\neq \beta\)</span>. Proof in appendix.</p>
<p>It also means that <span class="math inline">\(Cov(Y,\epsilon)\neq 0\)</span>. In other words, that <span class="math inline">\(y\)</span> and <span class="math inline">\(\epsilon\)</span> somehow move jointly due to some unobserved factors and not due <strong>only</strong> to variation due to <span class="math inline">\(X\)</span>.</p>
<p>We will see many ways to tackle this issue.</p>
<ul>
<li>Today: <strong>Omitted Variable Bias</strong></li>
<li>Next week: <strong>Endogeneity</strong>.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Extensive presentation of the derivations and the Gauss-Markov theorem <a href="https://web.stanford.edu/~mrosenfe/soc_meth_proj3/matrix_OLS_NYU_notes.pdf">here</a>.</p>
</div>
</div>
<hr>
<p>A third case leads to an unbiased estimator with higher standard errors (not the <em>best</em> estimator anymore): <strong>measurement error</strong>. The intuition behind measurement error is more straightforward:</p>
<p>If <span class="math inline">\(x = x^\star + \delta\)</span> where <span class="math inline">\(\delta\)</span> is a measurement error with mean 0, then the estimator is still unbiased but the variance is higher and the estimation is leess precise.</p>
</section>
</section>
<section id="linear-regression-8" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-8">Linear regression</h2>
<section id="r2-and-prediction-quality" class="level3">
<h3 class="anchored" data-anchor-id="r2-and-prediction-quality">R2 and prediction quality</h3>
<ul>
<li>R2 is the coefficient of determination, assessing the share of total variance explained by the model</li>
</ul>
<p><span class="math display">\[\small
R^2 = \frac{\texttt{Variance explained}}{\texttt{Total variance}} = \frac{\text{Sum of explained square}}{\text{Total sum of square}} = 1 - \frac{\text{Sum of square residuals}}{\text{Total sum of square}}
\]</span></p>
<ul>
<li>R2 is between 0 and 1</li>
<li>The higher the R2, the larger the share of variance explained by the model</li>
<li>A low R2 is not necessarily bad: it is just that the model explains a low share of variance</li>
</ul>
</section>
</section>
<section id="linear-regression-9" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-9">Linear regression</h2>
<section id="interpretation" class="level3">
<h3 class="anchored" data-anchor-id="interpretation">Interpretation</h3>
<ul>
<li>Once the model set, we can estimate it using R functions</li>
<li>Main function is <code>lm</code>. For linear model, the syntax is <code>lm(y ~ x)</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(cars<span class="sc">$</span>dist <span class="sc">~</span> cars<span class="sc">$</span>speed))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cars$dist ~ cars$speed)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.069  -9.525  -2.272   9.215  43.201 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -17.5791     6.7584  -2.601   0.0123 *  
cars$speed    3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared:  0.6511,    Adjusted R-squared:  0.6438 
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
</div>
<ul>
<li>Results are significant (low p-value), R2 is relatively large</li>
</ul>
</section>
</section>
<section id="linear-regression-10" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-10">Linear regression</h2>
<section id="p-value" class="level3">
<h3 class="anchored" data-anchor-id="p-value">P-value</h3>
<p>The <code>Pr(&gt;|t|)</code> value is also called the <strong>p-value</strong>. Let’s assume that we want to have a significance level <span class="math inline">\(\alpha\)</span> of 5%. The underlying statistical test is the following:</p>
<p><span class="math display">\[
\begin{align*}
H_0 : \beta = 0 \\
H_1 : \beta \neq 0
\end{align*}
\]</span></p>
<p>where <span class="math inline">\(\beta\)</span> is the <em>true</em> coefficient.</p>
<p>We want to know if, conditional on the fact that <span class="math inline">\(H_0\)</span> is true (the true parameter value is 0), <span class="math inline">\(\widehat \beta = 3.93\)</span> is due to pure chance (then we keep <span class="math inline">\(H_0\)</span>) or if it cannot be due to chance (and we reject <span class="math inline">\(H_0\)</span>).</p>
<p>If the p-value falls below the threshold <span class="math inline">\(\alpha\)</span>, then we can confidently assume that the coefficient is significantly different from 0. In other words, we reject the hypothesis that the speed has no influence on the stopping distance at the 5% level.</p>
<p>For more details, you can check this quick <a href="https://gregorygundersen.com/blog/2021/09/09/ols-hypothesis-testing/">note</a>.</p>
</section>
</section>
<section id="linear-regression-11" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-11">Linear regression</h2>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Everything should be intepreted <strong>everything else equal</strong>!</p>
</div>
</div>
<ul>
<li><p>Level-level regression: marginal effect. If <span class="math inline">\(x\)</span> increases by 1, <span class="math inline">\(y\)</span> increases by <span class="math inline">\(\beta\)</span></p></li>
<li><p>Log-log regression: elasticity. If <span class="math inline">\(x\)</span> increases by 1%, <span class="math inline">\(y\)</span> increases by <span class="math inline">\(\beta\)</span>%</p></li>
<li><p>Log-level regression: percentage change. If <span class="math inline">\(x\)</span> increases by 1, <span class="math inline">\(y\)</span> increases by <span class="math inline">\(100\beta\)</span></p></li>
<li><p>Level-log regression: level change. If <span class="math inline">\(x\)</span> increases by 1%, <span class="math inline">\(y\)</span> increases by <span class="math inline">\(\beta/100\)</span></p></li>
</ul>
</section>
</section>
<section id="from-the-model-to-the-data" class="level2">
<h2 class="anchored" data-anchor-id="from-the-model-to-the-data">From the model to the data</h2>
<section id="solow-model" class="level3">
<h3 class="anchored" data-anchor-id="solow-model">Solow model</h3>
<ul>
<li><p>Using Harrod-neutral technological progress, the GDP per capita equation is: <span class="math display">\[\small
\frac{Y(t)}{L(t)} = K(t)^\alpha (A(t) L(t))^{1-\alpha} \quad \alpha \in \ (0,1)
\]</span></p></li>
<li><p>We assume an exogenous growth rate of <span class="math inline">\(A\)</span> and <span class="math inline">\(L\)</span> such that: <span class="math inline">\(A(t) = A(0)e^{gt}\)</span> and <span class="math inline">\(L(t) = L(0) e^{nt}\)</span>.</p></li>
<li><p>At the steady-state level:</p></li>
</ul>
<p><span class="math display">\[\small
\frac{Y}{L} = A(0)e^{gt}\left(\frac{s}{n + g + \delta}\right)^{\alpha/(1-\alpha)}
\]</span></p>
<ul>
<li>Super convenient: we can measure everything
<ul>
<li><span class="math inline">\(Y/L\)</span>, GDP divided by working age population</li>
<li><span class="math inline">\(s\)</span>, saving measured as the real investment</li>
<li><span class="math inline">\(n\)</span>, population growth rate</li>
<li><span class="math inline">\(\delta\)</span> and <span class="math inline">\(g\)</span>, capital depreciation and growth rate of technology (assumed constant)</li>
</ul></li>
</ul>
</section>
</section>
<section id="from-the-model-to-the-data-1" class="level2">
<h2 class="anchored" data-anchor-id="from-the-model-to-the-data-1">From the model to the data</h2>
<section id="is-this-relationship-linear" class="level3">
<h3 class="anchored" data-anchor-id="is-this-relationship-linear">Is this relationship linear?</h3>
<p><strong>No</strong>. Solution?</p>
<div class="fragment">
<p>Log-linearize it (at time 0)</p>
<p><span class="math display">\[
\log (Y/L) = \log(A(0)) + \left(\frac{\alpha}{1-\alpha}\right)\log s - \left(\frac{\alpha}{1-\alpha}\right) \log(n + g + \delta)
\]</span></p>
</div>
</section>
</section>
<section id="from-the-model-to-the-data-2" class="level2">
<h2 class="anchored" data-anchor-id="from-the-model-to-the-data-2">From the model to the data</h2>
<section id="empirical-model" class="level3">
<h3 class="anchored" data-anchor-id="empirical-model">Empirical model</h3>
<p>Because we do not observe all data, we can only <em>estimate</em> the parameters. Hence, the empirical model we estimate is:</p>
<p><span class="math display">\[
\log (Y_i/L_i) = \beta_0 + \beta_1 \log s_i + \beta_2 \log(n + g + \delta) + \epsilon_i
\]</span></p>
<p>where <span class="math inline">\(\beta_0 + \epsilon_i = \log A(0)\)</span>, and <span class="math inline">\(\epsilon_i\)</span> is an error term capturing everything not captured in the model.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We can, or not, assume that <span class="math inline">\(\beta_1 = -\beta_2\)</span>. This is an empirical prediction we might want to test.</p>
</div>
</div>
</section>
</section>
<section id="exercise" class="level2">
<h2 class="anchored" data-anchor-id="exercise">Exercise</h2>
<section id="data-cleaning-and-descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning-and-descriptive-statistics">Data cleaning and descriptive statistics</h3>
<ol type="1">
<li>Load the data and the packages (<code>dplyr</code> and <code>ggplot2</code>)</li>
<li>What are the three groups of countries in the data?</li>
<li>Compute summary statistics based on country group</li>
<li>Plot the growth rate of GDP per capita vs.&nbsp;the log of GDP per capita</li>
</ol>
</section>
</section>
<section id="exercise-1" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1">Exercise</h2>
<section id="baseline-estimation" class="level3">
<h3 class="anchored" data-anchor-id="baseline-estimation">Baseline estimation</h3>
<p>Assume <span class="math inline">\(g+\delta=0.05\)</span>.</p>
<ol type="1">
<li>Generate the variables you need in the regression</li>
<li>Run the model on the full sample and on each sub-group. Store the results in appropriate objects.
<ul>
<li><em>[Bonus]</em> Use a loop to do it</li>
</ul></li>
<li>Interpret the results in the light of the Solow model predictions. What is the share of cross-country income per capita variation is explained by the model?</li>
<li><em>[Bonus]</em> We assumed that <span class="math inline">\(\beta_1 \neq -\beta_2\)</span>. Using <code>linearHypothesis()</code> from the package <code>car</code>, you can set an hypothesis testing to check if the sum of the coefficient is equal to 0.</li>
<li>In previous work, the share of capital in production was thought to be roughly 1/3, is this prediction supported by the data?</li>
</ol>
</section>
</section>
<section id="exercise-2" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2">Exercise</h2>
<section id="adding-the-human-capital" class="level3">
<h3 class="anchored" data-anchor-id="adding-the-human-capital">Adding the human capital</h3>
<ol type="1">
<li>Does the previous model violate the exogeneity assumption? Why?</li>
<li>A proposed solution is to add a new variable to capture the level of human capital: <code>school</code>.</li>
<li>Run again the model on the full and sub- samples.</li>
<li>Interpret.</li>
<li>Export the tables and the graph in LaTeX</li>
</ol>
</section>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<section id="anscombe-quartet" class="level3">
<h3 class="anchored" data-anchor-id="anscombe-quartet">Anscombe quartet</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">=</span> <span class="fu">ggplot</span>(datasets<span class="sc">::</span>anscombe,<span class="fu">aes</span>(<span class="at">x=</span>x1,<span class="at">y=</span>y1)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,<span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Q1"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">=</span> <span class="fu">ggplot</span>(datasets<span class="sc">::</span>anscombe,<span class="fu">aes</span>(<span class="at">x=</span>x2,<span class="at">y=</span>y2)) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,<span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Q2"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">=</span> <span class="fu">ggplot</span>(datasets<span class="sc">::</span>anscombe,<span class="fu">aes</span>(<span class="at">x=</span>x3,<span class="at">y=</span>y3)) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,<span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Q3"</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">=</span> <span class="fu">ggplot</span>(datasets<span class="sc">::</span>anscombe,<span class="fu">aes</span>(<span class="at">x=</span>x4,<span class="at">y=</span>y4)) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,<span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"X"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Y"</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Q4"</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>(g1 <span class="sc">|</span> g2) <span class="sc">/</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>(g3 <span class="sc">|</span> g4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial3_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="appendix-1" class="level2">
<h2 class="anchored" data-anchor-id="appendix-1">Appendix</h2>
<section id="omitted-variable-bias-proof" class="level3">
<h3 class="anchored" data-anchor-id="omitted-variable-bias-proof">Omitted variable bias proof</h3>
<p>Omitted Variable Bias (OVB) occurs when a relevant variable is left out of a regression model, leading to biased and inconsistent estimators. Here, we formally prove the presence of bias in the Ordinary Least Squares (OLS) estimator due to an omitted variable.</p>
<p>Consider the true model: <span class="math inline">\(Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon\)</span> where <span class="math inline">\(Y\)</span> is the dependent variable, <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are explanatory variables, <span class="math inline">\(\epsilon\)</span> is the error term with <span class="math inline">\(E[\epsilon | X_1, X_2] = 0\)</span>.</p>
<p>Now, suppose <span class="math inline">\(X_2\)</span> is omitted from the regression. The estimated model is: <span class="math display">\[
Y = \alpha_0 + \alpha_1 X_1 + u
\]</span></p>
<p>where the new error term <span class="math inline">\(u\)</span> is: <span class="math inline">\(u = \beta_2 X_2 + \epsilon\)</span>. Since <span class="math inline">\(X_2\)</span> is omitted, we express it in terms of <span class="math inline">\(X_1\)</span> using the linear projection:</p>
<p><span class="math display">\[
X_2 = \gamma_0 + \gamma_1 X_1 + v
\]</span></p>
<p>where <span class="math inline">\(v\)</span> is the residual such that <span class="math inline">\(E[v | X_1] = 0\)</span>.</p>
<hr>
<p>Substituting this into the omitted equation:</p>
<p><span class="math display">\[
u = \beta_2 (\gamma_0 + \gamma_1 X_1 + v) + \epsilon
\]</span></p>
<p><span class="math display">\[
u = \beta_2 \gamma_0 + \beta_2 \gamma_1 X_1 + \beta_2 v + \epsilon
\]</span></p>
<p>Since <span class="math inline">\(u\)</span> is correlated with <span class="math inline">\(X_1\)</span>, the OLS estimator for <span class="math inline">\(\alpha_1\)</span> (which is another way to write an estimator) is:</p>
<p><span class="math display">\[
\hat{\alpha}_1 = \frac{Cov(Y, X_1)}{Var(X_1)}
\]</span></p>
<p>Substituting <span class="math inline">\(Y\)</span> from the true model:</p>
<p><span class="math display">\[
\hat{\alpha}_1 = \frac{Cov(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon, X_1)}{Var(X_1)}
\]</span></p>
<p>Expanding covariance terms:</p>
<p><span class="math display">\[
\hat{\alpha}_1 = \beta_1 + \beta_2 \frac{Cov(X_2, X_1)}{Var(X_1)}
\]</span></p>
<hr>
<p>Using the projection equation:</p>
<p><span class="math display">\[
\hat{\alpha}_1 = \beta_1 + \beta_2 \gamma_1
\]</span></p>
<p>Since <span class="math inline">\(\gamma_1 \neq 0\)</span> if <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are correlated, and <span class="math inline">\(\beta_2 \neq 0\)</span> if <span class="math inline">\(X_2\)</span> is relevant, it follows that:</p>
<p><span class="math display">\[
E[\hat{\alpha}_1] \neq \beta_1
\]</span></p>
<p>Thus, the OLS estimator is biased due to the omission of <span class="math inline">\(X_2\)</span>. Another way of seeing it on these <a href="https://hedibert.org/wp-content/uploads/2016/09/Bias-omittedvariable.pdf">slides</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Mateo Moglia</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>