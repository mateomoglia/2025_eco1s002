<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Tutorial 4: Econometrics with R (Solution) – Petite classe ECO1S002</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-94ab712f215f0f28cf75fcc61d4e0fd5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      Petite classe ECO1S002
      </li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Petite classe ECO1S002</a> 
    </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 1</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 2</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 3</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorial4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tutorial 4</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
   
  <ul>
  <li><a href="#recap" id="toc-recap" class="nav-link active" data-scroll-target="#recap">Recap</a></li>
  <li><a href="#exercise-1-solow-model-and-ovb" id="toc-exercise-1-solow-model-and-ovb" class="nav-link" data-scroll-target="#exercise-1-solow-model-and-ovb">Exercise 1: Solow model and OVB</a>
  <ul class="collapse">
  <li><a href="#baseline-solow-model" id="toc-baseline-solow-model" class="nav-link" data-scroll-target="#baseline-solow-model">Baseline Solow model</a></li>
  <li><a href="#adding-school-as-omitted-variable" id="toc-adding-school-as-omitted-variable" class="nav-link" data-scroll-target="#adding-school-as-omitted-variable">Adding school as omitted variable</a></li>
  </ul></li>
  <li><a href="#exercise-2-acemoglu-johnson-robinson-and-instrumental-variable" id="toc-exercise-2-acemoglu-johnson-robinson-and-instrumental-variable" class="nav-link" data-scroll-target="#exercise-2-acemoglu-johnson-robinson-and-instrumental-variable">Exercise 2: Acemoglu, Johnson, Robinson and instrumental variable</a>
  <ul class="collapse">
  <li><a href="#recap-1" id="toc-recap-1" class="nav-link" data-scroll-target="#recap-1">Recap</a></li>
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1">Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">Part 2</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tutorial 4: Econometrics with R (Solution)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="recap" class="level2">
<h2 class="anchored" data-anchor-id="recap">Recap</h2>
<p>Last week, we discovered the OLS estimator and what it does. It allows to assess, under certain conditions, the linear relation between an explained variable <span class="math inline">\(y\)</span> and explanatory variables <span class="math inline">\(X\)</span>, using <span class="math inline">\(n\)</span> individual observations.</p>
<p>Recall that OLS estimator is biased. If the estimator is biased <span class="math inline">\(E(\epsilon|X) \neq 0\)</span>. Bias may arise in three main cases:</p>
<ol type="1">
<li>Measurement error. If the observed value <span class="math inline">\(\tilde{X}\)</span> of the real variable <span class="math inline">\(X\)</span> is biased, then it writes <span class="math inline">\(\tilde{X} = X + \mu\)</span>. Then the exogeneity assumption does not hold.</li>
<li>Omitted variable bias. The true model is <span class="math inline">\(y_i = \alpha + \beta_1 x_i + \beta_2 z_i + \epsilon_i\)</span>. If we estimate <span class="math inline">\(y_i = \alpha + \beta_1 x_i + \epsilon_i\)</span>, we may under- or over-estimate the effect of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</li>
<li>Reverse causality (or simultaneity). The true model is <span class="math display">\[
\begin{align*}
y_i &amp;= \alpha_0 + \alpha_1 x_i + \alpha_2 z_i + u_i \\
x_i &amp;= \beta_0 + \beta_1 y_i + \beta_2 z_i + v_i
\end{align*}
\]</span></li>
</ol>
<p>Rearranging yields a reduced-form model <span class="math inline">\(y_i = \pi_0 + \pi_1 z_i + \pi_2 x_i + e_i\)</span>, but <span class="math inline">\(e_i\)</span> contains both <span class="math inline">\(u_i\)</span> and <span class="math inline">\(z_i\)</span> and the exogeneity assumption might be violated.</p>
</section>
<section id="exercise-1-solow-model-and-ovb" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-solow-model-and-ovb">Exercise 1: Solow model and OVB</h2>
<p>Dataset <code>MRW_QJE1992.xlsx</code> can be downloaded on Moodle.</p>
<section id="baseline-solow-model" class="level3">
<h3 class="anchored" data-anchor-id="baseline-solow-model">Baseline Solow model</h3>
<p>Before, we load the necessary libraries and create an object <code>path</code> to store the path for further use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">=</span> <span class="st">"C:/users/mateomoglia/dropbox/courses/polytechnique/2025_eco1s002/tutorial3"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Open the dataset with the function <code>read_xlsx</code> from the package <code>readxl</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">read_xlsx</span>(<span class="fu">paste0</span>(path,<span class="st">"/data/MRW_QJE1992.xlsx"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Describe the dataset</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     number         country                n                i         
 Min.   :  0.00   Length:128         Min.   :0.0000   Min.   :0.0000  
 1st Qu.: 25.75   Class :character   1st Qu.:1.0000   1st Qu.:0.0000  
 Median : 57.50   Mode  :character   Median :1.0000   Median :1.0000  
 Mean   : 57.66                      Mean   :0.8099   Mean   :0.6198  
 3rd Qu.: 89.25                      3rd Qu.:1.0000   3rd Qu.:1.0000  
 Max.   :121.00                      Max.   :1.0000   Max.   :1.0000  
                                     NA's   :7        NA's   :7       
       o             rgdpw60           rgdpw85        gdpgrowth     
 Min.   :0.0000   Min.   :  383.0   Min.   :  412   Min.   :-0.900  
 1st Qu.:0.0000   1st Qu.:  973.2   1st Qu.: 1209   1st Qu.: 2.800  
 Median :0.0000   Median : 1962.0   Median : 3484   Median : 3.900  
 Mean   :0.1818   Mean   : 3681.8   Mean   : 5683   Mean   : 4.094  
 3rd Qu.:0.0000   3rd Qu.: 4274.5   3rd Qu.: 7719   3rd Qu.: 5.300  
 Max.   :1.0000   Max.   :77881.0   Max.   :25635   Max.   : 9.200  
 NA's   :7        NA's   :12        NA's   :20      NA's   :11      
   popgrowth          i_y            school       countrycode       
 Min.   :0.300   Min.   : 4.10   Min.   : 0.400   Length:128        
 1st Qu.:1.700   1st Qu.:12.00   1st Qu.: 2.400   Class :character  
 Median :2.400   Median :17.70   Median : 4.950   Mode  :character  
 Mean   :2.279   Mean   :18.16   Mean   : 5.526                     
 3rd Qu.:2.900   3rd Qu.:24.10   3rd Qu.: 8.175                     
 Max.   :6.800   Max.   :36.90   Max.   :12.100                     
 NA's   :21      NA's   :7       NA's   :10                         </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
  number country         n     i     o rgdpw60 rgdpw85 gdpgrowth popgrowth   i_y
   &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;
1      1 Algeria         1     1     0    2485    4371       4.8       2.6  24.1
2      2 Angola          1     0     0    1588    1171       0.8       2.1   5.8
3      3 Benin           1     0     0    1116    1071       2.2       2.4  10.8
4      4 Botswana        1     1     0     959    3671       8.6       3.2  28.3
5      5 Burkina Fa…     1     0     0     529     857       2.9       0.9  12.7
6      6 Burundi         1     0     0     755     663       1.2       1.7   5.1
# ℹ 2 more variables: school &lt;dbl&gt;, countrycode &lt;chr&gt;</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Using <code>ggplot2</code> package, make a graph to plot on the <span class="math inline">\(x\)</span> axis the GDP growth and on the <span class="math inline">\(y\)</span> axis the log GDP in 1965. Export in <code>pdf</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> gdpgrowth, <span class="at">y =</span> <span class="fu">log</span>(rgdpw60))) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"GDP growth rate"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"GDP per capita in 1960 (log)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial4_sol_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(path,<span class="st">"/output/graph_solow.pdf"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Saving 7 x 5 in image</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 12 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>In the paper, different country groups are defined. Create the grouping variable, depending on country types. Hint: use <code>ifelse(test,value if true, value if false)</code>. Notice that countries <span class="math inline">\(o\)</span> are a subset of countries <span class="math inline">\(i\)</span> which are a subset of countries <span class="math inline">\(n\)</span>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(n <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"n"</span>, <span class="cn">NA</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(i <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"i"</span>, group)) <span class="sc">%&gt;%</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(o <span class="sc">==</span> <span class="dv">1</span>, <span class="st">"o"</span>, group)) <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(group)) <span class="co"># Some countries are not part of a group, we remove them</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="5" type="1">
<li>Estimate this model and store in an object called <code>reg0</code> <span class="math display">\[
\log (Y_i/L_i) = \beta_0 + \beta_1 \log s_i + \beta_2 \log(n + g + \delta) + \epsilon_i
\]</span></li>
</ol>
<p>We define <span class="math inline">\(g + \delta = 0.05\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the variables for the regression ------------------------------------</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">constant =</span> <span class="fl">0.05</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Unconditional and conditional regressions ------------------------------------</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>reg0 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(rgdpw85) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(i_y) <span class="sc">+</span> <span class="fu">log</span>(popgrowth <span class="sc">+</span> constant), <span class="at">data =</span> dat)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(rgdpw85) ~ 1 + log(i_y) + log(popgrowth + constant), 
    data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.74635 -0.42958  0.04203  0.44671  1.50149 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 4.5890     0.4322  10.618  &lt; 2e-16 ***
log(i_y)                    1.3881     0.1416   9.804 4.33e-16 ***
log(popgrowth + constant)  -0.5301     0.1298  -4.085 9.19e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6759 on 95 degrees of freedom
Multiple R-squared:  0.6159,    Adjusted R-squared:  0.6078 
F-statistic: 76.17 on 2 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Estimate the same model but for each country subgroup.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>reg0_i <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(rgdpw85) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(i_y) <span class="sc">+</span> <span class="fu">log</span>(popgrowth <span class="sc">+</span> constant), <span class="at">data =</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"i"</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>reg0_n <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(rgdpw85) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(i_y) <span class="sc">+</span> <span class="fu">log</span>(popgrowth <span class="sc">+</span> constant), <span class="at">data =</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"n"</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>reg0_o <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(rgdpw85) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(i_y) <span class="sc">+</span> <span class="fu">log</span>(popgrowth <span class="sc">+</span> constant), <span class="at">data =</span> dat <span class="sc">%&gt;%</span> <span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"o"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="7" type="1">
<li>Bonus: do the latter with a loop</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"i"</span>,<span class="st">"o"</span>,<span class="st">"n"</span>)){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  reg <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(rgdpw85) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(i_y) <span class="sc">+</span> <span class="fu">log</span>(popgrowth <span class="sc">+</span> constant), <span class="at">data =</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(group <span class="sc">==</span> x))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"reg0_"</span>,x),reg)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="8" type="1">
<li>This is the result we find. Interpret it (notice the log-log specification)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(rgdpw85) ~ 1 + log(i_y) + log(popgrowth + constant), 
    data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.74635 -0.42958  0.04203  0.44671  1.50149 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 4.5890     0.4322  10.618  &lt; 2e-16 ***
log(i_y)                    1.3881     0.1416   9.804 4.33e-16 ***
log(popgrowth + constant)  -0.5301     0.1298  -4.085 9.19e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6759 on 95 degrees of freedom
Multiple R-squared:  0.6159,    Adjusted R-squared:  0.6078 
F-statistic: 76.17 on 2 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The R2 is around 62%, it means that the model we specified explains 62% of the total variance of the log GDP in 1985 in our sample. It also highlights that 38% of the variance is left unexplained by the model.</p>
<p>Thanks to the log-log specification, the coefficients we found on investment and on the constant terms <span class="math inline">\((n+g+\delta)\)</span> can directly be interpreted as elasticities (if <span class="math inline">\(x\)</span> increases by 1%, <span class="math inline">\(y\)</span> increases by <span class="math inline">\(\widehat\beta\)</span>%). Here, one percent increase in investment increases GDP per capita in 1985 by 1.4%.</p>
<p>Notice that the coefficients we found are stastistically significant at a very high level. The p-value is way below the standard treshold of 1%.</p>
<ol start="9" type="1">
<li>Previous work estimated that the elasticity of production with respect to investment is 1/3. Is this verified here?</li>
</ol>
<p>The <span class="math inline">\(\beta\)</span> we estimate is in the Solow model the <span class="math inline">\(\alpha/(1-\alpha)\)</span>. Hence, if <span class="math inline">\(\beta = 1.4\)</span>, then <span class="math inline">\(\alpha \sim 0.6\)</span>, which is almost two times the value of previous estimation.</p>
</section>
<section id="adding-school-as-omitted-variable" class="level3">
<h3 class="anchored" data-anchor-id="adding-school-as-omitted-variable">Adding school as omitted variable</h3>
<p>In the extension of the Solow model, we saw that human capital has a role in explaining GDP per capita.</p>
<ol start="9" type="1">
<li>Run the model again but adding the <code>school</code> variable. Interpret.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the school variable ------------------------------------------------------</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>reg1 <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(rgdpw85) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(i_y) <span class="sc">+</span> <span class="fu">log</span>(popgrowth <span class="sc">+</span> constant) <span class="sc">+</span> <span class="fu">log</span>(school), <span class="at">data =</span> dat)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(rgdpw85) ~ 1 + log(i_y) + log(popgrowth + constant) + 
    log(school), data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.27082 -0.33776  0.06629  0.32580  1.09789 

Coefficients:
                          Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                5.59342    0.33733  16.581  &lt; 2e-16 ***
log(i_y)                   0.68265    0.13045   5.233 1.01e-06 ***
log(popgrowth + constant) -0.45041    0.09599  -4.692 9.16e-06 ***
log(school)                0.64347    0.07146   9.004 2.41e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4979 on 94 degrees of freedom
Multiple R-squared:  0.7938,    Adjusted R-squared:  0.7872 
F-statistic: 120.6 on 3 and 94 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="fu">c</span>(<span class="st">"i"</span>,<span class="st">"o"</span>,<span class="st">"n"</span>)){</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  reg <span class="ot">=</span> <span class="fu">lm</span>(<span class="fu">log</span>(rgdpw85) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fu">log</span>(i_y) <span class="sc">+</span> <span class="fu">log</span>(popgrowth <span class="sc">+</span> constant) <span class="sc">+</span> <span class="fu">log</span>(school), <span class="at">data =</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(group <span class="sc">==</span> x))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">"reg1_"</span>,x),reg)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All coefficients remain significant. The R2 increases. Addind school increases the overall explanatory power of the model (note however that the R2 increases mechanically with the number of variables). It suggests that the coefficient was a missing a value. The coefficient on school is positive and significant. Increases education increases GDP.</p>
<ol start="10" type="1">
<li>Bonus: Using <code>linearHypothesis</code> test if <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span> are equal.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>hypothesis.matrix <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>) , <span class="at">nrow=</span><span class="dv">1</span> , <span class="at">ncol =</span><span class="dv">3</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(car<span class="sc">::</span><span class="fu">linearHypothesis</span>(reg0, hypothesis.matrix, <span class="at">rhs=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Linear hypothesis test:


Model 1: restricted model
Model 2: log(rgdpw85) ~ 1 + log(i_y) + log(popgrowth + constant)

  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1     96 50.372                                  
2     95 43.405  1    6.9661 15.246 0.0001765 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The test p-value is lower than the usual threshold of 1%, we can confidently reject the hypothesis that the two coefficients are equal.</p>
</section>
</section>
<section id="exercise-2-acemoglu-johnson-robinson-and-instrumental-variable" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-acemoglu-johnson-robinson-and-instrumental-variable">Exercise 2: Acemoglu, Johnson, Robinson and instrumental variable</h2>
<section id="recap-1" class="level3">
<h3 class="anchored" data-anchor-id="recap-1">Recap</h3>
<p>In this very influential paper, AJR estimates the effects of institution on GDP growth. They in particular test whether good institutions, hat protect entrepreneurs, enhance the GDP per capita growth in the African context.</p>
<p>However, there is a clear endogeneity issue. Can you see it? <em>Richer countries can afford having better institution because they can invest in better schools/universities or better voters are more in favor of better institutions to protect their wealth</em></p>
</section>
<section id="part-1" class="level3">
<h3 class="anchored" data-anchor-id="part-1">Part 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   Solution for tutorial 4</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ivreg)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">=</span> <span class="st">"C:/users/mateomoglia/dropbox/courses/polytechnique/2025_eco1s002/tutorial4"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">read_dta</span>(<span class="fu">paste0</span>(path,<span class="st">"/data/ajrcomment.dta"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Download the dataset <code>ajrcomment.dta</code> and describe the data</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   longname           shortnam              step            mort        
 Length:64          Length:64          Min.   :1.000   Min.   :   8.55  
 Class :character   Class :character   1st Qu.:1.000   1st Qu.:  68.90  
 Mode  :character   Mode  :character   Median :3.000   Median :  78.15  
                                       Mean   :2.562   Mean   : 245.91  
                                       3rd Qu.:4.000   3rd Qu.: 240.00  
                                       Max.   :4.000   Max.   :2940.00  
                                                                        
    logmort0          risk            loggdp          campaign     
 Min.   :2.146   Min.   : 3.500   Min.   : 6.110   Min.   :0.0000  
 1st Qu.:4.233   1st Qu.: 5.617   1st Qu.: 7.303   1st Qu.:0.0000  
 Median :4.359   Median : 6.475   Median : 7.940   Median :1.0000  
 Mean   :4.647   Mean   : 6.516   Mean   : 8.051   Mean   :0.6562  
 3rd Qu.:5.481   3rd Qu.: 7.353   3rd Qu.: 8.852   3rd Qu.:1.0000  
 Max.   :7.986   Max.   :10.000   Max.   :10.220   Max.   :1.0000  
                                                                   
     slave           source0          latitude         neoeuro      
 Min.   :0.0000   Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0889   1st Qu.:0.0000  
 Median :0.0000   Median :0.0000   Median :0.1528   Median :0.0000  
 Mean   :0.0625   Mean   :0.4375   Mean   :0.1811   Mean   :0.0625  
 3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:0.2584   3rd Qu.:0.0000  
 Max.   :1.0000   Max.   :1.0000   Max.   :0.6667   Max.   :1.0000  
                                                                    
      asia            africa           other            edes1975     
 Min.   :0.0000   Min.   :0.0000   Min.   :0.00000   Min.   :  0.00  
 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:  0.00  
 Median :0.0000   Median :0.0000   Median :0.00000   Median :  0.00  
 Mean   :0.1406   Mean   :0.4219   Mean   :0.04688   Mean   : 18.07  
 3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:0.00000   3rd Qu.: 21.25  
 Max.   :1.0000   Max.   :1.0000   Max.   :1.00000   Max.   :100.00  
                                                                     
    malaria           other2            cons90         lado1995    
 Min.   :0.0000   Min.   :0.00000   Min.   :1.000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:0.00000   1st Qu.:2.000   1st Qu.:3.000  
 Median :0.1757   Median :0.00000   Median :3.000   Median :4.000  
 Mean   :0.4099   Mean   :0.07812   Mean   :3.967   Mean   :3.714  
 3rd Qu.:1.0000   3rd Qu.:0.00000   3rd Qu.:7.000   3rd Qu.:4.000  
 Max.   :1.0000   Max.   :1.00000   Max.   :7.000   Max.   :6.000  
 NA's   :2                          NA's   :4       NA's   :1      
    ajr_rnd2     
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.4688  
 3rd Qu.:1.0000  
 Max.   :1.0000  
                 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 21
  longname    shortnam  step   mort logmort0  risk loggdp campaign slave source0
  &lt;chr&gt;       &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
1 Angola      AGO          3 280        5.63  5.36   7.77        1     0       0
2 Argentina   ARG          4  68.9      4.23  6.39   9.13        1     0       0
3 Australia   AUS          4   8.55     2.15  9.32   9.90        0     0       0
4 Burkina Fa… BFA          2 280        5.63  4.45   6.85        1     0       0
5 Bangladesh  BGD          1  71.4      4.27  5.14   6.88        1     0       1
6 Bahamas     BHS          4  85        4.44  7.5    9.29        0     0       0
# ℹ 11 more variables: latitude &lt;dbl&gt;, neoeuro &lt;dbl&gt;, asia &lt;dbl&gt;, africa &lt;dbl&gt;,
#   other &lt;dbl&gt;, edes1975 &lt;dbl&gt;, malaria &lt;dbl&gt;, other2 &lt;dbl&gt;, cons90 &lt;dbl&gt;,
#   lado1995 &lt;dbl&gt;, ajr_rnd2 &lt;dbl&gt;</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Create a scatter plot of mortality rate against GDP per capita in 1995, and a second scatter plot with the log mortality rate and log GDP per capita in 1995. Notice the difference.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot -----------------------------------------------------------------</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> mort, <span class="at">y =</span> loggdp)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"indianred"</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial4_sol_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> dat, <span class="fu">aes</span>(<span class="at">x =</span> logmort0, <span class="at">y =</span> loggdp)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"indianred"</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial4_sol_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Table 2 of Acemoglu et al.&nbsp;(2001) presents the results of an OLS regression of log GDP per capita in 1995 on average protection against expropriation, and a some covariates:</p>
<p><span class="math display">\[
    \log y_i = \mu + \alpha R_i + \mathbf{X}_i'\gamma + \epsilon_i
\]</span></p>
<ol start="3" type="1">
<li>Identify the covariates in the results table.</li>
</ol>
<p><em>The covariates are latitude, a variable that takes one if the country is in Asia (also called a dummy variable), a dummy if the country is in Africa, an “other continent” dummy.</em></p>
<ol start="4" type="1">
<li>Reproduce the results for the columns (2), (5), and (6). Export them to your answer sheet. Interpret the results clearly.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>reg0_nocov  <span class="ot">=</span> <span class="fu">lm</span>(loggdp <span class="sc">~</span> risk, <span class="at">data =</span> dat)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>reg0_lat    <span class="ot">=</span> <span class="fu">lm</span>(loggdp <span class="sc">~</span> risk <span class="sc">+</span> latitude, <span class="at">data =</span> dat)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>reg0_allcov <span class="ot">=</span> <span class="fu">lm</span>(loggdp <span class="sc">~</span> risk <span class="sc">+</span> latitude <span class="sc">+</span> asia <span class="sc">+</span> africa <span class="sc">+</span> other, <span class="at">data =</span> dat)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(reg0_nocov,reg0_lat, reg0_allcov,<span class="at">type =</span> <span class="st">"text"</span>, <span class="at">out =</span> <span class="fu">paste0</span>(path,<span class="st">"/output/reg0.tex"</span>), <span class="at">keep.stat =</span> <span class="fu">c</span>(<span class="st">"n"</span>, <span class="st">"rsq"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
==========================================
                  Dependent variable:     
             -----------------------------
                        loggdp            
                (1)       (2)       (3)   
------------------------------------------
risk         0.516***  0.457***  0.396*** 
              (0.063)   (0.065)   (0.060) 
                                          
latitude                1.710**    0.978  
                        (0.722)   (0.641) 
                                          
asia                             -0.651***
                                  (0.236) 
                                          
africa                           -0.879***
                                  (0.173) 
                                          
other                              0.103  
                                  (0.390) 
                                          
Constant     4.687***  4.761***  5.754*** 
              (0.417)   (0.404)   (0.406) 
                                          
------------------------------------------
Observations    64        64        64    
R2             0.524     0.564     0.705  
==========================================
Note:          *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>What is the effect of an increase of 1 on the risk scale on the GDP?</li>
</ol>
<p>1 unit increase in risk increases by 39 percent the country GDP. The result is significant at the 1% level. Notice that the effect of risk on GDP is robust to the add of other variables. It suggests a strong relationship between both.</p>
</section>
<section id="part-2" class="level3">
<h3 class="anchored" data-anchor-id="part-2">Part 2</h3>
<p>So far, we used OLS to estimate the effect of risk on GDP. However, the relationship is likely to be endogenous. Hence, we can risk with mortality to aleviate this endogeneity concern. We run two different methods:</p>
<ol start="6" type="1">
<li>Run the regression of risk on log mortality (using only latitude as a covariate).</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>fs <span class="ot">=</span> <span class="fu">lm</span>(risk <span class="sc">~</span> logmort0 <span class="sc">+</span> latitude, <span class="at">data =</span> dat)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = risk ~ logmort0 + latitude, data = dat)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7321 -0.9389  0.0495  0.8417  3.1898 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   8.5558     0.8083  10.585 1.94e-15 ***
logmort0     -0.5172     0.1409  -3.672 0.000509 ***
latitude      2.0075     1.3299   1.510 0.136331    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.249 on 61 degrees of freedom
Multiple R-squared:  0.2997,    Adjusted R-squared:  0.2767 
F-statistic: 13.05 on 2 and 61 DF,  p-value: 1.913e-05</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Run the regression of predicted risk on GDP (using only latitude as a covariate). To do so, you need to estimate the predicted risk based on the previous regression result using the <code>predict</code> function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>risk_hat <span class="ot">=</span> <span class="fu">predict</span>(fs)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>risk_hat <span class="ot">=</span> risk_hat</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dat,<span class="fu">aes</span>(<span class="at">x=</span>risk_hat,risk)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="tutorial4_sol_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(loggdp <span class="sc">~</span> risk_hat <span class="sc">+</span> latitude,<span class="at">data=</span>dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = loggdp ~ risk_hat + latitude, data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.49222 -0.46453  0.08935  0.47819  1.59812 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.8578     0.9638   1.928   0.0586 .  
risk_hat      0.9620     0.1652   5.824  2.3e-07 ***
latitude     -0.4169     1.0011  -0.416   0.6786    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7576 on 61 degrees of freedom
Multiple R-squared:  0.4937,    Adjusted R-squared:  0.4771 
F-statistic: 29.74 on 2 and 61 DF,  p-value: 9.65e-10</code></pre>
</div>
</div>
<p><code>predict</code> computes <span class="math inline">\(\widehat x_i = \widehat\beta_0 \widehat \beta_1 z_i + \widehat u_i\)</span>. Here, <span class="math inline">\(\widehat x\)</span> is the predicted risk. Then, I add the object <code>risk_hat</code> as a new column in the <code>dat</code> dataset.</p>
<p>A good instrument has to check two assumptions. The first one is the <strong>relevance</strong>, meaning that the instrument must be correlated with the instrumented variable. The second one is <strong>exogeneity</strong>, meaning that <span class="math inline">\(z\)</span> must not cause <span class="math inline">\(y\)</span>. This cannot be directly tested for.</p>
<ol start="8" type="1">
<li>Does the instrument seem valid? Comment the results.</li>
</ol>
<p>Instrument is relevant as the coefficient in <code>fs</code> is positive and significant. Instrument seems to be exogenous. Lagged mortality (over a century ago) seems not to have an effect on contemporeneous outcome through another way than through institutional context. Check David Albouy critique for a critical assessment of the AJR strategy.</p>
<ol start="9" type="1">
<li>Discover the function <code>ivreg</code> and do the IV regression again. Do the results differ?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">ivreg</span>(loggdp <span class="sc">~</span> risk <span class="sc">+</span> latitude <span class="sc">|</span> logmort0 <span class="sc">+</span> latitude, <span class="at">data =</span> dat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
ivreg(formula = loggdp ~ risk + latitude | logmort0 + latitude, 
    data = dat)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.48221 -0.61459  0.09125  0.73670  1.79187 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.8578     1.2592   1.475    0.145    
risk          0.9620     0.2158   4.458 3.61e-05 ***
latitude     -0.4169     1.3079  -0.319    0.751    

Diagnostic tests:
                 df1 df2 statistic  p-value    
Weak instruments   1  61     13.48 0.000509 ***
Wu-Hausman         1  60     16.61 0.000137 ***
Sargan             0  NA        NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9898 on 61 degrees of freedom
Multiple R-Squared: 0.1358, Adjusted R-squared: 0.1075 
Wald test: 17.42 on 2 and 61 DF,  p-value: 1.033e-06 </code></pre>
</div>
</div>
<p>Results are the same, which is expected!</p>
<p>Solution are <a href="tutorial4_sol">here</a>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2025, Mateo Moglia</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>